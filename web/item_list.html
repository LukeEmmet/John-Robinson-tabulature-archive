<html>
<head>
		<style>
			table, th, td,span {
			margin-left: 12px;
			margin-right: 12px;
			}
			.coll_name {
				font-size: large;
				font-weight: bold;
			}
			.mei_button, tc_button {
			  display: inline-block;
			  border: 1px solid red;
			}
			.mei_button {
				background: pink;
			}
			.tc_button {
				background: yellow;
			}
		</style>
	<script>
		const queryString = window.location.search;
		const urlParams = new URLSearchParams(queryString);
		const collection = urlParams.get('coll_name');
		const coll_title = urlParams.get('coll_title');

		function write_title(coll_name) {
			document.write("<span class='coll_name' style='font-size:large;font-weight:bold'>Files in: "+collection+"</span><p>");
			document.write("<button onclick='list_files(collection)'>Load files</button>");
		}
	
	</script>
</head>
<body onload="write_title(collection)">
<!-- 
<body onload="listItems(); write_title(collection)">
 -->
<script>
	console.log("collection: "+collection)
	console.log("coll_title: "+coll_title)
		var piece = 0;	
	var items = [];
		
	function list_files(collection) {
		document.write("<table>")
console.log("getting files in "+collection)

getFilesInDirectory(collection+"tc_files",".tc");

// var tc_files = '<?php $tc_dir = $_GET["coll_name"] ."/tc_files/"; $tcs = glob($tc_dir."*.tc"); echo json_encode($tcs);?>'
// console.log(tc_files)
		for(var i = 0; i<tc_files.length;i++) {
// 			document.write("<tr><td>"+(i+1)+".</td><td><i>"+tc_files[i]+"</i></td><td><span class='mei_button'><a target='_blank' href='"+mei_file+"'>MEI</a></span></td><td><span class='tc_button'><a target='_blank' href='"+tc_file+"'>TC</a></span></td></tr>");
			document.write("<tr><td>"+(i+1)+".</td><td><i>"+tc_files[i]+"</i></td><td><span class='mei_button'><a target='_blank' href=''>MEI</a></span></td><td><span class='tc_button'><a target='_blank' href=''>TC</a></span></td></tr>");
		}
		
		document.write("</table>")
	}

	function listItems() {
		var file = "./all.titles";
		var name = "";
	items.length = 0;
		fetch(file)
		  .then(response => response.text())
		  .then((data) => {
			data.split(/\r?\n/).forEach(line =>  {
				parseItemLine(line);
			});
			console.log("There are "+items.length+" items.")
		  })
	}
	function parseItemLine(str) {
		if(!str) return
		var part = str.split("	");
		var parts = part.length;
	
		var name = part[0];
		var item_title = part[1];
	
		var item = new Object;
		item.number=item;
		item.name=name;
		item.title=item_title;
	
		items.push(item);
		item++;
	}

	function doesFileExist(urlToFile) {
	    var xhr = new XMLHttpRequest();
	    xhr.open('HEAD', urlToFile, false);
	    xhr.send();
	    return xhr.status !== 404;
	}

</script>
<!-- <button onclick="write_title(collection);list_files(collection)">Load files</button> -->
<!-- <button onclick="list_files(collection)">Load files</button> -->
<div id=header></div>
<div id=display></div>

</body>
</html>
